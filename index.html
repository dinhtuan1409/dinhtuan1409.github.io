<!DOCTYPE html>
<html lang="vi" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kỷ niệm 2 năm</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Great Vibes', 'cursive'],
                    },
                    colors: {
                        'custom-bg': '#f0f7ff',
                        'custom-text': '#2c3e50',
                        'custom-light': '#cfe2f3',
                        'custom-accent': '#7aa8bf',
                    }
                }
            }
        }
    </script>
    
    <style>
        /* Hiệu ứng mũi tên nhấp nháy */
        @keyframes bounce {
            0%, 100% {
                transform: translateY(-25%);
                animation-timing-function: cubic-bezier(0.8, 0, 1, 1);
            }
            50% {
                transform: translateY(0);
                animation-timing-function: cubic-bezier(0, 0, 0.2, 1);
            }
        }
        .animate-bounce {
            animation: bounce 1.5s infinite;
        }
    </style>
</head>
<body class="font-sans antialiased bg-custom-bg text-custom-text">

    <audio id="backgroundMusic" autoplay loop muted>
        <source src="music/lovesong.mp3" type="audio/mp3">
        Trình duyệt của bạn không hỗ trợ phần tử audio.
    </audio>
    
    <button id="toggleMusicBtn" 
            class="fixed top-4 right-4 z-50 p-2 bg-custom-accent/80 text-white rounded-full shadow-lg hover:bg-custom-accent transition duration-200">
        <svg id="musicOnIcon" class="w-6 h-6 hidden" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.536 7.425A1.75 1.75 0 008 8.75v3.5c0 .777.834 1.253 1.536.825l3.5-2.25a1.75 1.75 0 000-2.85l-3.5-2.25z" clip-rule="evenodd" />
        </svg>
        <svg id="musicOffIcon" class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
            <path d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.75 8a.75.75 0 00-.75.75v3.5a.75.75 0 001.5 0V9.5h1.25a.75.75 0 00.75-.75V8a.75.75 0 00-.75-.75H9.5a.75.75 0 00-.75.75zM12 11.25a.75.75 0 000 1.5h1.5a.75.75 0 000-1.5H12zM7.75 11.25a.75.75 0 000 1.5h1.5a.75.75 0 000-1.5H7.75z" />
        </svg>
    </button>


    <section id="hero" class="h-screen w-full flex flex-col justify-center items-center relative text-white" 
             style="background-image: url('img/38.jpg'); background-size: cover; background-position: center;">
        
        <div class="absolute inset-0 bg-black/50"></div>
        
        <div class="relative z-10 text-center p-4">
            <h1 class="font-display text-6xl md:text-8xl mb-4">2 Năm Cùng Nhau</h1>
            <h2 class="text-3xl md:text-4xl mb-2 font-light tracking-wide">[BiQi] & [DiTi]</h2>
            <p class="text-lg opacity-90">Ngày 14 tháng 11 năm 2022 - Ngày chúng ta bắt đầu</p>
        </div>
        
        <a href="#story" class="absolute bottom-10 z-10 animate-bounce" aria-label="Cuộn xuống phần câu chuyện">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path></svg>
        </a>
    </section>

    <section id="story" class="py-24 px-6">
        <div class="max-w-3xl mx-auto text-center">
            <h2 class="font-display text-5xl md:text-6xl mb-8">Chuyện của chúng mình...</h2>
            <img src="img/story-start.jpg" 
                 alt="Ngày đầu tiên" 
                 class="w-full max-w-lg mx-auto rounded-lg shadow-xl mb-8 object-contain h-auto"
                 onerror="this.src='img/anh10.jpg'">
            <p class="text-lg md:text-xl leading-relaxed">
                Hai năm trước, chúng ta đã tìm thấy nhau. Mọi thứ bắt đầu thật đơn giản/bất ngờ/tình cờ, và từ đó, chúng ta đã có một hành trình thật đẹp.
            </p>
        </div>
    </section>

    <section id="gallery" class="py-24 px-6 bg-white">
        <div class="max-w-7xl mx-auto">
            <h2 class="font-display text-5xl md:text-6xl text-center mb-16">Những Mảnh Ghép Kỷ Niệm</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="bg-custom-bg rounded-lg shadow-xl overflow-hidden transform hover:scale-105 transition-transform duration-300 cursor-pointer"
                     onclick="openGallery('album1')" role="button" aria-label="Mở Album 1: Những Chuyến Đi">
                    <img src="img/bia3.png" alt="Những chuyến đi" class="w-full h-64 object-contain" onerror="this.src='https://placehold.co/600x400'">
                    <div class="p-6">
                        <h3 class="text-2xl font-semibold mb-2">Album 1: Những Chuyến Đi</h3>
                        <p class="text-custom-text/80">"Những nơi chúng ta đã cùng nhau khám phá"</p>
                    </div>
                </div>
                
                <div class="bg-custom-bg rounded-lg shadow-xl overflow-hidden transform hover:scale-105 transition-transform duration-300 cursor-pointer"
                     onclick="openGallery('album2')" role="button" aria-label="Mở Album 2: Góc Ẩm Thực">
                    <img src="img/bia4.png" alt="Góc ẩm thực" class="w-full h-64 object-contain" onerror="this.src='https://placehold.co/600x400'">
                    <div class="p-6">
                        <h3 class="text-2xl font-semibold mb-2">Album 2: Góc Ẩm Thực</h3>
                        <p class="text-custom-text/80">"Hạnh phúc đôi khi chỉ là một bữa ăn ngon..."</p>
                    </div>
                </div>
                
                <div class="bg-custom-bg rounded-lg shadow-xl overflow-hidden transform hover:scale-105 transition-transform duration-300 cursor-pointer"
                     onclick="openGallery('album3')" role="button" aria-label="Mở Album 3: Chỉ Là Ngày Bình Thường">
                    <img src="img/bia5.png" alt="Ngày bình thường" class="w-full h-64 object-contain" onerror="this.src='https://placehold.co/600x400'">
                    <div class="p-6">
                        <h3 class="text-2xl font-semibold mb-2">Album 3: Chỉ Là Ngày Bình Thường</h3>
                        <p class="text-custom-text/80">"Yêu cả những lúc bình yên và 'lầy lội' thế này."</p>
                    </div>
                </div>
                
                <div class="bg-custom-bg rounded-lg shadow-xl overflow-hidden transform hover:scale-105 transition-transform duration-300 cursor-pointer"
                     onclick="openGallery('album4')" role="button" aria-label="Mở Album 4: Những Dịp Đặc Biệt">
                    <img src="img/bia1.png" alt="Dịp đặc biệt" class="w-full h-64 object-contain" onerror="this.src='https://placehold.co/600x400'">
                    <div class="p-6">
                        <h3 class="text-2xl font-semibold mb-2">Album 4: Những Dịp Đặc Biệt</h3>
                        <p class="text-custom-text/80">"Sinh nhật, Giáng sinh, Valentine bên nhau..."</p>
                    </div>
                </div>
                
                <div class="bg-custom-bg rounded-lg shadow-xl overflow-hidden transform hover:scale-105 transition-transform duration-300 cursor-pointer"
                     onclick="openGallery('album5')" role="button" aria-label="Mở Album 5: Gương Mặt Thương Hiệu">
                    <img src="img/bia2.png" alt="Gương mặt thương hiệu" class="w-full h-64 object-contain" onerror="this.src='https://placehold.co/600x400'">
                    <div class="p-6">
                        <h3 class="text-2xl font-semibold mb-2">Album 5: Gương Mặt "Thương Hiệu"</h3>
                        <p class="text-custom-text/80">"Những bức ảnh 'phó nháy' của nhau chụp."</p>
                    </div>
                </div>

            </div>
        </div>
    </section>

    <section id="then-now" class="py-24 px-6">
        <div class="max-w-5xl mx-auto text-center">
            <h2 class="font-display text-5xl md:text-6xl mb-16">Chúng ta của 2 năm</h2>
            <div class="flex flex-col md:flex-row justify-center items-center gap-8 md:gap-12">
                <div class="flex-1">
                    <img src="img/35.jpg" alt="Bức ảnh đầu tiên" class="w-full rounded-lg shadow-xl object-contain h-auto" onerror="this.src='https://placehold.co/600x600'">
                    <h3 class="text-2xl font-semibold mt-6">Bức Ảnh Đầu Tiên</h3>
                </div>
                
                <div class="hidden md:block">
                    <svg class="w-12 h-12 text-custom-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>
                </div>
                
                <div class="flex-1">
                    <img src="img/11.jpg" alt="Bức ảnh gần đây" class="w-full rounded-lg shadow-xl object-contain h-auto" onerror="this.src='https://placehold.co/600x600'">
                    <h3 class="text-2xl font-semibold mt-6">Bức Ảnh Gần Đây</h3>
                </div>
            </div>
            <p class="text-lg md:text-xl leading-relaxed mt-12 max-w-2xl mx-auto">
                "Từ bỡ ngỡ đến thân thuộc. Chúng ta đã cùng nhau trưởng thành..."
            </p>
        </div>
    </section>

    <section id="fun-facts" class="py-24 px-6 bg-white">
        <div class="max-w-3xl mx-auto">
            <h2 class="font-display text-5xl md:text-6xl text-center mb-16">Chỉ chúng ta mới hiểu</h2>
            <ul class="space-y-6 text-lg">
                <li class="flex items-center bg-gray-50 p-5 rounded-lg shadow-md">
                    <svg class="w-8 h-8 mr-5 text-custom-accent flex-shrink-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M5.25 3A2.25 2.25 0 003 5.25v9.5A2.25 2.25 0 005.25 17h9.5A2.25 2.25 0 0017 14.75v-9.5A2.25 2.25 0 0014.75 3h-9.5zM3.75 5.25c0-.414.336-.75.75-.75h.75c.414 0 .75.336.75.75v.75c0 .414-.336.75-.75.75h-.75a.75.75 0 01-.75-.75v-.75zm2.25.75c0 .414.336.75.75.75h3.5a.75.75 0 000-1.5h-3.5a.75.75 0 00-.75.75zm0 3c0 .414.336.75.75.75h3.5a.75.75 0 000-1.5h-3.5a.75.75 0 00-.75.75zm0 3c0 .414.336.75.75.75h3.5a.75.75 0 000-1.5h-3.5a.75.75 0 00-.75.75zm9.25-5.25v.75c0 .414-.336.75-.75.75h-.75a.75.75 0 01-.75-.75v-.75c0-.414.336-.75.75-.75h.75c.414 0 .75.336.75.75zm-.75 2.25h.75c.414 0 .75.336.75.75v3.5a.75.75 0 01-1.5 0v-3.5a.75.75 0 01.75-.75z" />
                    </svg>
                    <span><strong>Món ăn cả hai cùng thích:</strong> [Điền vào đây, ví dụ: Bún chả hoặc Trà sữa]</span>
                </li>
                <li class="flex items-center bg-gray-50 p-5 rounded-lg shadow-md">
                    <svg class="w-8 h-8 mr-5 text-custom-accent flex-shrink-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M3.25 4A2.25 2.25 0 001 6.25v7.5A2.25 2.25 0 003.25 16h13.5A2.25 2.25 0 0019 13.75v-7.5A2.25 2.25 0 0016.75 4H3.25zM2.5 6.25c0-.414.336-.75.75-.75h13.5c.414 0 .75.336.75.75v7.5c0 .414-.336.75-.75.75H3.25a.75.75 0 01-.75-.75v-7.5zM5 8.25a.75.75 0 000 1.5h1.5a.75.75 0 000-1.5H5zM6.5 10.5a.75.75 0 01.75-.75h1.5a.75.75 0 010 1.5H7.25a.75.75 0 01-.75-.75zM5 12.75a.75.75 0 000 1.5h1.5a.75.75 0 000-1.5H5zM10.75 8a.75.75 0 01.75-.75h1.5a.75.75 0 010 1.5h-1.5a.75.75 0 01-.75-.75zM9.25 10.5a.75.75 0 000 1.5h1.5a.75.75 0 000-1.5H9.25zM10.75 12a.75.75 0 01.75-.75h1.5a.75.75 0 010 1.5h-1.5a.75.75 0 01-.75-.75zM15 8.25a.75.75 0 000 1.5h1.5a.75.75 0 000-1.5H15zM13.5 10.5a.75.75 0 01.75-.75h1.5a.75.75 0 010 1.5h-1.5a.75.75 0 01-.75-.75zM15 12.75a.75.75 0 000 1.5h1.5a.75.75 0 000-1.5H15z" />
                    </svg>
                    <span><strong>Bộ phim cả hai cùng "cày":</strong> [Điền vào đây, ví dụ: Friends hoặc một phim Hàn]</span>
                </li>
                <li class="flex items-center bg-gray-50 p-5 rounded-lg shadow-md">
                    <svg class="w-8 h-8 mr-5 text-custom-accent flex-shrink-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M7 4a3 3 0 013 3v2.066c0 1.004.607 1.89 1.503 2.302.2.092.38.204.536.338a2.5 2.5 0 01-.84 4.294A3 3 0 017 13V7a3 3 0 010-6c1.657 0 3 1.343 3 3v2.066c0 1.004.607 1.89 1.503 2.302.2.092.38.204.536.338a2.5 2.5 0 01-.84 4.294A3 3 0 017 13V7c0-1.657-1.343-3-3-3S1 5.343 1 7v6a3 3 0 003 3c1.657 0 3-1.343 3-3V7c0-1.657-1.343-3-3-3z" />
                        <path d="M12.75 3a.75.75 0 000 1.5h.5a2 2 0 012 2v6.5a2.5 2.5 0 01-2.5 2.5h-.5a.75.75 0 000 1.5h.5a4 4 0 004-4V6.5a3.5 3.5 0 00-3.5-3.5h-.5z" />
                    </svg>
                    <span><strong>Bài hát "của chúng mình":</strong> [Điền tên bài hát vào đây]</span>
                </li>
                <li class="flex items-center bg-gray-50 p-5 rounded-lg shadow-md">
                    <svg class="w-8 h-8 mr-5 text-custom-accent flex-shrink-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M9.653 16.915l-.005-.003-.019-.01a20.759 20.759 0 01-1.162-.682 22.045 22.045 0 01-2.582-1.9C4.045 12.733 2 10.352 2 7.5a4.5 4.5 0 018-2.828A4.5 4.5 0 0118 7.5c0 2.852-2.044 5.233-3.885 6.82a22.049 22.049 0 01-3.744 2.582l-.019.01-.005.003h-.002a.739.739 0 01-.69.001l-.002-.001z" />
                    </svg>
                    <span><strong>Thói quen "kỳ lạ" mà bạn yêu:</strong> [Điền thói quen của người ấy]</span>
                </li>
            </ul>
        </div>
    </section>

    <section id="note" class="py-24 px-6">
        <div class="max-w-3xl mx-auto text-center">
            <h2 class="font-display text-5xl md:text-6xl mb-8">Gửi người em thương,</h2>
            <img src="img/14.jpg" 
                 alt="Người thương" 
                 class="w-full max-w-md mx-auto rounded-lg shadow-xl mb-10 object-contain h-auto"
                 onerror="this.src='https://placehold.co/600x600'">
            
            <div class="text-lg md:text-xl text-left italic leading-loose space-y-5 bg-white p-8 md:p-12 rounded-lg shadow-inner">
                <p>Cảm ơn em vì đã luôn ở bên anh, trong cả những lúc vui vẻ lẫn khi khó khăn. Hai năm qua là một hành trình tuyệt vời, lấp đầy bởi những tiếng cười, những bài học và vô vàn yêu thương.</p>
                <p>Điều anh yêu nhất ở em là... [Hãy viết điều bạn trân trọng nhất ở người ấy vào đây. Ví dụ: ...là nụ cười của em, là cách em quan tâm đến mọi thứ xung quanh, hoặc là sự kiên nhẫn của em với anh].</p>
                <p>Hai năm là một chặng đường, và chúng ta sẽ cùng nhau viết tiếp thật nhiều chương hạnh phúc nữa. Yêu em rất nhiều.</p>
            </div>
        </div>
    </section>

    <footer class="py-16 bg-custom-text text-custom-bg text-center">
        <h3 class="font-display text-4xl md:text-5xl mb-4">Happy 2nd Anniversary!</h3>
        <p class="text-lg opacity-90">Cùng nhau, cho những hành trình tiếp theo.</p>
        <p class="mt-6 text-sm opacity-70">Tạo bởi [Tên Của Bạn] với tất cả tình yêu</p>
    </footer>

    <div id="galleryModal" class="fixed inset-0 bg-black/70 hidden items-center justify-center z-[9999] p-4" aria-hidden="true" role="dialog" aria-modal="true">
        <div class="bg-white rounded-xl max-w-4xl w-full relative p-4 shadow-xl flex flex-col max-h-[90vh]">
            
            <button id="closeGalleryBtn" aria-label="Đóng" 
                    class="absolute top-3 right-3 text-3xl font-bold text-gray-500 hover:text-black z-30">&times;</button>

            <h3 id="albumTitle" class="text-2xl font-semibold mb-4 text-center flex-shrink-0"></h3>

           <div id="albumContent" class="relative w-full flex-grow flex flex-col justify-center min-h-[60vh] md:min-h-[70vh] p-4">
                <div id="slidesContainer" class="w-full max-h-[90vh] relative overflow-hidden bg-black rounded-lg flex items-center justify-center p-4">
                </div>
             
                <!-- Nút prev/next và index giữ nguyên -->
      

                <button id="nextBtn" class="absolute right-0 top-1/2 transform -translate-y-1/2 p-3 bg-black/50 text-white rounded-l-lg z-20 hover:bg-black/80 transition" aria-label="Tiếp theo">
                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 5l7 7-7 7"></path></svg>
                </button>

                <button id="prevBtn" class="absolute left-0 top-1/2 transform -translate-y-1/2 p-3 bg-black/50 text-white rounded-r-lg z-20 hover:bg-black/80 transition" aria-label="Trước đó">
                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M15 19l-7-7 7-7"></path></svg>
                </button>

                <div id="slideIndex" class="absolute bottom-6 left-1/2 transform -translate-x-1/2 bg-black/50 text-white px-4 py-1 rounded text-lg z-20 font-medium"></div>
            </div>

        </div>
    </div>

    <section id="final-question" class="py-24 px-6 bg-custom-light text-center">
        <div class="max-w-3xl mx-auto">
            <h2 class="font-display text-5xl md:text-6xl mb-12">Em có đồng ý yêu anh suốt đời không?</h2>
            
            <div class="relative flex justify-center gap-16 h-40 items-center">
                <button id="yesBtn" class="bg-custom-accent text-white text-2xl md:text-3xl font-semibold py-4 px-10 rounded-xl transition-all duration-300">
                    Yes ❤️
                </button>
                <button id="noBtn" class="bg-red-500 text-white text-2xl md:text-3xl font-semibold py-4 px-10 rounded-xl transition-all duration-300">
                    No ❌
                </button>
            </div>
        </div>
    </section>

    <script>
        /* Danh sách nội dung của từng album */
        const albumImages = {
            album1: {
                title: "Album 1: Những Chuyến Đi",
                items: [
                    { src: "video/video14.mp4", type: "video" },
                    { src: "https://picsum.photos/800/600", type: "image" },
                    { src: "video/video13.mp4", type: "video" }, 
                    { src: "video/video8.mp4", type: "video" },
                    { src: "img/38.jpg", type: "image" }, 
                    { src: "img/anh18.jpg", type: "image" }
                ]
            },
            album2: {
                title: "Album 2: Ngày Bình Thường",
                items: [
                    { src: "video/video2.mp4", type: "video" },
                    { src: "video/video3.mp4", type: "video" },
                    { src: "video/video7.mp4", type: "video" },
                    { src: "video/video5.mp4", type: "video" },
                    { src: "video/video11.mp4", type: "video" },
                    { src: "img/4.jpg", type: "image" }, 
                    { src: "img/5.jpg", type: "image" }, 
                    { src: "img/12.jpg", type: "image" },
                    { src: "img/21.jpg", type: "image" },
                    { src: "img/anh20.jpg", type: "image" }
                ]
            },
            album3: {
                title: "Album 3: Stalk đời đầu",
                items: [
                    { src: "img/46.jpg", type: "image" }, 
                    { src: "img/anh2.jpg", type: "image" },
                    { src: "img/25.jpg", type: "image" },
                    { src: "img/22.jpg", type: "image" },
                    { src: "img/anh19.jpg", type: "image" }
                ]
            },
            album4: {
                title: "Album 4: Những ngày đi chơi",
                items: [
                    { src: "video/video6.mp4", type: "video" },
                    { src: "video/video9.mp4", type: "video" },
                    { src: "img/anh10.jpg", type: "image" },
                    { src: "img/39.jpg", type: "image" }, 
                    { src: "img/anh16.jpg", type: "image" }, 
                    { src: "img/36.jpg", type: "image" }, 
                    { src: "img/6.jpg", type: "image" },
                    { src: "img/40.jpg", type: "image" },
                    { src: "img/32.jpg", type: "image" },
                    { src: "img/anh8.jpg", type: "image" },
                    { src: "img/anh41.jpg", type: "image" },
                    { src: "img/13.jpg", type: "image" },
                    { src: "img/tet.jpg", type: "image" },
                ]
            },
            album5: {
                title: "Album 5: Công chúa của anh",
                items: [
                    { src: "img/34.jpg", type: "image" }, 
                    { src: "img/3.jpg", type: "image" }, 
                    { src: "img/23.jpg", type: "image" }, 
                    { src: "img/27.jpg", type: "image" },
                    { src: "img/28.jpg", type: "image" },
                    { src: "img/37.jpg", type: "image" },
                    { src: "img/47.jpg", type: "image" },
                    { src: "img/48.jpg", type: "image" },
                    { src: "img/anh15.jpg", type: "image" },
                    { src: "img/anh11.jpg", type: "image" },
                    { src: "img/44.jpg", type: "image" },
                ]
            }
        };

        const modal = document.getElementById("galleryModal");
        const albumTitleEl = document.getElementById("albumTitle");
        const closeGalleryBtn = document.getElementById("closeGalleryBtn");
        
        // CÁC BIẾN CHO TRÌNH CHIẾU
        const slidesContainerEl = document.getElementById("slidesContainer");
        const nextBtn = document.getElementById("nextBtn");
        const prevBtn = document.getElementById("prevBtn");
        const slideIndexEl = document.getElementById("slideIndex");

        let currentAlbumItems = [];
        let currentSlideIndex = 0;
        
        // Audio elements (Giữ nguyên)
        const backgroundMusic = document.getElementById('backgroundMusic');
        const toggleMusicBtn = document.getElementById('toggleMusicBtn');
        const musicOnIcon = document.getElementById('musicOnIcon');
        const musicOffIcon = document.getElementById('musicOffIcon');
        let isMutedByUser = false; 

        // -------------------------------------
        // VÙNG CODE XỬ LÝ AUDIO (Giữ nguyên)
        // -------------------------------------

        function startMutedPlayback() {
            backgroundMusic.play().catch(error => {});
        }

        const enableAudio = () => {
            if (!backgroundMusic.muted || isMutedByUser) {
                return;
            }

            backgroundMusic.play().then(() => {
                backgroundMusic.muted = false; 
                musicOnIcon.classList.remove('hidden');
                musicOffIcon.classList.add('hidden');
            }).catch(error => {
                console.log("Không thể tự động bật tiếng. Cần tương tác thêm.");
            });
            
            document.removeEventListener('click', enableAudio);
            document.removeEventListener('scroll', enableAudio);
            document.removeEventListener('touchstart', enableAudio);
        };

        toggleMusicBtn.addEventListener('click', () => {
            if (backgroundMusic.muted) {
                backgroundMusic.muted = false; 
                backgroundMusic.play();
                isMutedByUser = false; 
                musicOnIcon.classList.remove('hidden');
                musicOffIcon.classList.add('hidden');
            } else {
                backgroundMusic.muted = true; 
                backgroundMusic.pause(); 
                isMutedByUser = true; 
                musicOnIcon.classList.add('hidden');
                musicOffIcon.classList.remove('hidden');
            }
        });

        startMutedPlayback();
        document.addEventListener('click', enableAudio, { once: true });
        document.addEventListener('scroll', enableAudio, { once: true });
        document.addEventListener('touchstart', enableAudio, { once: true }); 
        // -------------------------------------
        // END VÙNG CODE XỬ LÝ AUDIO
        // -------------------------------------

        // -------------------------------------
        // CÁC HÀM XỬ LÝ TRÌNH CHIẾU MỚI (Đã thêm check lỗi đường dẫn)
        // -------------------------------------

        function showSlide(n) {
            if (currentAlbumItems.length === 0) return;

            currentSlideIndex = (n + currentAlbumItems.length) % currentAlbumItems.length;
            slidesContainerEl.querySelectorAll('video').forEach(v => v.pause());
            slidesContainerEl.innerHTML = '';

            const item = currentAlbumItems[currentSlideIndex];
            const wrapper = document.createElement('div');
            wrapper.className = "flex items-center justify-center w-full h-auto max-h-[90vh]";

            if (item.type === 'image') {
                const img = new Image();
                img.src = item.src;
                img.alt = 'Kỷ niệm';
                img.className = "max-w-full max-h-[90vh] w-auto h-auto object-contain rounded-lg shadow-2xl";

                img.onload = () => {
                    // Tự động điều chỉnh chiều cao container theo ảnh
                    slidesContainerEl.style.height = 'auto';
                    slidesContainerEl.style.minHeight = '50vh';
                    wrapper.appendChild(img);
                    slidesContainerEl.appendChild(wrapper);
                };

                img.onerror = () => {
                    wrapper.innerHTML = `<div class="text-red-400 bg-black/80 p-6 rounded-lg text-center">Lỗi ảnh: ${item.src}</div>`;
                    slidesContainerEl.appendChild(wrapper);
                };
            } 
            else if (item.type === 'video') {
                const video = document.createElement('video');
                video.src = item.src;
                video.controls = true;
                video.autoplay = true;
                video.muted = true;
                video.loop = true;
                video.playsInline = true;
                video.className = "max-w-full max-h-[90vh] w-auto h-auto object-contain rounded-lg shadow-2xl";

                video.onloadstart = () => {
                    slidesContainerEl.style.height = 'auto';
                    slidesContainerEl.style.minHeight = '50vh';
                };

                video.onerror = () => {
                    wrapper.innerHTML = `<div class="text-red-400 bg-black/80 p-6 rounded-lg text-center">Lỗi video: ${item.src}</div>`;
                };

                wrapper.appendChild(video);
                slidesContainerEl.appendChild(wrapper);
            }

            slideIndexEl.textContent = `${currentSlideIndex + 1} / ${currentAlbumItems.length}`;
        }
        function nextSlide() {
            showSlide(currentSlideIndex + 1);
        }

        function prevSlide() {
            showSlide(currentSlideIndex - 1);
        }

        // HÀM MỞ GALLERY
        function openGallery(albumId) {
            const data = albumImages[albumId];
            if (!data) return;

            albumTitleEl.textContent = data.title;
            
            // Lưu trữ nội dung album hiện tại
            currentAlbumItems = data.items;
            
            // Thiết lập sự kiện cho nút điều hướng (đảm bảo chỉ thêm 1 lần)
            nextBtn.removeEventListener("click", nextSlide); 
            prevBtn.removeEventListener("click", prevSlide);
            nextBtn.addEventListener("click", nextSlide);
            prevBtn.addEventListener("click", prevSlide);

            // Kích hoạt slide đầu tiên
            showSlide(0);

            // Hiển thị Modal
            modal.classList.remove("hidden");
            modal.classList.add("flex");
            modal.setAttribute("aria-hidden", "false");
            document.body.style.overflow = "hidden";
        }

        function closeGallery() {
            // Dừng video hiện tại nếu có
            slidesContainerEl.querySelectorAll('video').forEach(video => {
                video.pause();
            });
            modal.classList.add("hidden");
            modal.classList.remove("flex");
            modal.setAttribute("aria-hidden", "true");
            document.body.style.overflow = ""; // restore
        }

        closeGalleryBtn.addEventListener("click", closeGallery);
        modal.addEventListener("click", (e) => {
            // Đóng modal khi nhấp ra ngoài (chỉ khi target là modal overlay)
            if (e.target === modal) closeGallery();
        });
        
        document.addEventListener("keydown", (e) => {
            if (!modal.classList.contains("hidden")) {
                if (e.key === "ArrowRight") {
                    nextSlide();
                } else if (e.key === "ArrowLeft") {
                    prevSlide();
                } else if (e.key === "Escape") {
                    closeGallery();
                }
            }
        });

        // CODE HIỆU ỨNG NÚT "NO" (Giữ nguyên)
        const yesBtn = document.getElementById("yesBtn");
        const noBtn = document.getElementById("noBtn");
        let noCounter = 0; 
        let yesScale = 1;

        function moveNoButton() {
            const container = noBtn.parentElement;
            const containerRect = container.getBoundingClientRect();
            const btnRect = noBtn.getBoundingClientRect();
            const yesRect = yesBtn.getBoundingClientRect();

            const yesX = yesBtn.offsetLeft;
            const yesY = yesBtn.offsetTop;
            
            const yesWidth = yesRect.width;
            const yesHeight = yesRect.height;
            
            const safeZone = 80; 

            const maxX = containerRect.width - btnRect.width;
            const maxY = containerRect.height - btnRect.height;

            let randX, randY;
            let isTooClose;

            do {
                randX = Math.random() * maxX;
                randY = Math.random() * maxY;

                const isLeft = randX + btnRect.width + safeZone < yesX;
                const isRight = randX > yesX + yesWidth + safeZone;
                const isAbove = randY + btnRect.height + safeZone < yesY;
                const isBelow = randY > yesY + yesHeight + safeZone;

                isTooClose = !(isLeft || isRight || isAbove || isBelow);

            } while (isTooClose || randX < 0 || randY < 0);

            noBtn.style.position = "absolute";
            noBtn.style.left = randX + "px";
            noBtn.style.top = randY + "px";
        }

        noBtn.addEventListener("mouseenter", () => {
            noCounter++;

            if(noCounter >= 5) {
                noBtn.style.display = "none";
                
            } else {
                moveNoButton();
                yesScale += 0.2;
                yesBtn.style.transform = `scale(${yesScale})`;
            }
        });

        yesBtn.addEventListener("click", () => {
            yesBtn.textContent = "Anh biết mà ❤️";
            yesBtn.style.transform = `scale(${yesScale + 0.2})`;
            noBtn.style.display = "none";
            
            toggleMusicBtn.style.display = 'none';
        });
    </script>
</body>
</html>